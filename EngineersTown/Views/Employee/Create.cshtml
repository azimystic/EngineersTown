@model Employee

<div class="max-w-4xl mx-auto">
    <div class="bg-white rounded-lg shadow-sm border border-gray-200">
        <div class="bg-gradient-to-r from-primary-600 to-primary-700 text-white px-6 py-4 rounded-t-lg">
            <h2 class="text-xl font-semibold flex items-center">
                <i class="fas fa-user-plus mr-3"></i>
                Create Employee
            </h2>
        </div>

        <div class="p-6">
            <form asp-action="Create" id="employeeForm">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-6">
                        <div>
                            <label asp-for="Name" class="block text-sm font-medium text-gray-700 mb-2"></label>
                            <input asp-for="Name" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500" />
                            <span asp-validation-for="Name" class="text-red-600 text-sm mt-1 block"></span>
                        </div>

                        <div>
                            <label asp-for="ZkedID" class="block text-sm font-medium text-gray-700 mb-2"></label>
                            <input asp-for="ZkedID" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500" />
                            <span asp-validation-for="ZkedID" class="text-red-600 text-sm mt-1 block"></span>
                        </div>

                        <div>
                            <label asp-for="CNIC" class="block text-sm font-medium text-gray-700 mb-2"></label>
                            <input asp-for="CNIC" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500" />
                            <span asp-validation-for="CNIC" class="text-red-600 text-sm mt-1 block"></span>
                        </div>

                        <div>
                            <label asp-for="DOB" class="block text-sm font-medium text-gray-700 mb-2"></label>
                            <input asp-for="DOB" type="date" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500" />
                            <span asp-validation-for="DOB" class="text-red-600 text-sm mt-1 block"></span>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div>
                            <label asp-for="DepartmentId" class="block text-sm font-medium text-gray-700 mb-2"></label>
                            <select asp-for="DepartmentId" asp-items="ViewBag.DepartmentId" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500" id="departmentSelect">
                                <option value="">-- Select Department --</option>
                            </select>
                            <span asp-validation-for="DepartmentId" class="text-red-600 text-sm mt-1 block"></span>
                        </div>

                        <div>
                            <label asp-for="DesignationId" class="block text-sm font-medium text-gray-700 mb-2"></label>
                            <select asp-for="DesignationId" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500" id="designationSelect">
                                <option value="">-- Select Designation --</option>
                            </select>
                            <span asp-validation-for="DesignationId" class="text-red-600 text-sm mt-1 block"></span>
                        </div>

                        <div>
                            <label asp-for="Type" class="block text-sm font-medium text-gray-700 mb-2"></label>
                            <select asp-for="Type" asp-items="ViewBag.EmployeeTypes" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500" id="Type">
                                <option value="">-- Select Type --</option>
                            </select>
                            <span asp-validation-for="Type" class="text-red-600 text-sm mt-1 block"></span>
                        </div>

                        <div id="contractExpiryGroup" class="hidden">
                            <label asp-for="ContractExpiryDate" class="block text-sm font-medium text-gray-700 mb-2"></label>
                            <input asp-for="ContractExpiryDate" type="date" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500" />
                            <span asp-validation-for="ContractExpiryDate" class="text-red-600 text-sm mt-1 block"></span>
                        </div>
                        <div id="BPSGroup" class="hidden">
                            <label asp-for="BPS" class="block text-sm font-medium text-gray-700 mb-2"></label>
                            <input asp-for="BPS" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500" />
                            <span asp-validation-for="BPS" class="text-red-600 text-sm mt-1 block"></span>
                        </div>
                    </div>
                </div>

                <div class="flex items-center space-x-4 mt-8">
                    <input type="submit" value="Create" class="px-4 py-2 bg-primary-600 text-white font-medium rounded-md hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200" />
                    <a asp-action="Index" class="px-4 py-2 bg-gray-600 text-white font-medium rounded-md hover:bg-gray-700 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors duration-200">Back to List</a>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Load designations when department changes
            $('#departmentSelect').change(function() {
                var departmentId = $(this).val();
                if (departmentId) {
                    $.getJSON('/Employee/GetDesignationsByDepartment', { departmentId: departmentId }, function(data) {
                        $('#designationSelect').empty().append('<option value="">-- Select Designation --</option>');
                        $.each(data, function(i, item) {
                            $('#designationSelect').append($('<option>', {
                                value: item.id,
                                text: item.name
                            }));
                        });
                    });
                } else {
                    $('#designationSelect').empty().append('<option value="">-- Select Designation --</option>');
                }
            });

            // Show/hide contract expiry date based on employee type
                   $('#Type').change(function() {
            // Get the current selected value of the dropdown
            var selectedValue = $(this).val();

            // 1. Handle visibility for 'contractExpiryGroup' (Value '002')
            if (selectedValue === '002') {
                $('#contractExpiryGroup').removeClass('hidden');
            } else {
                $('#contractExpiryGroup').addClass('hidden');
            }

            // 2. Handle visibility for 'BPSGroup' (Value '001')
            if (selectedValue === '001') {
                $('#BPSGroup').removeClass('hidden');
            } else {
                $('#BPSGroup').addClass('hidden');
            }
        });

            // Trigger change on page load in case of validation errors
            $('#Type').trigger('change');
        });
    </script>
}